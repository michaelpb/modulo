<!DOCTYPE HTML>
<head>
<script src="/js/codemirror_5.63.0/codemirror_bundled.js"></script>
    <meta charset="utf8">
    <title>API &amp; Extension - modulojs.org</title>
    <link rel="stylesheet" href="/js/codemirror_5.63.0/codemirror_bundled.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="icon" type="image/png" href="/img/mono_logo.png">
    
<style id="e2g1-Example_style">
e2g1-Example nav {
    background: black;
    color: gray;
    padding: 3px;
}
e2g1-Example a {
    color: lightblue;
    text-decoration: underline;
    cursor: pointer;
}
</style><style id="e4g1-Example_style">
e4g1-Example nav {
    background: black;
    color: gray;
    padding: 3px;
}
e4g1-Example a {
    color: lightblue;
    text-decoration: underline;
    cursor: pointer;
}
</style></head><body>


<nav class="Navbar">
    <a href="/index.html"><img src="/img/mono_logo.png" style="height:70px" alt="Modulo"></a>
    <ul>
        <li>
            <a href="/index.html#about">About</a>
        </li>
        <li>
            <a href="/start.html">Start</a>
        </li>
        <li>
            <a href="/docs/" class="Navbar--selected">Docs</a>
        </li>
    </ul>

    <div class="Navbar-rightInfo">
        v: undefined<br>
        SLOC: undefined lines<br>
        <a href="https://github.com/michaelpb/modulo/">github</a> | 
        <a href="https://npmjs.com/michaelpb/modulo/">npm</a> 
    </div>
</nav>


    <main class="Main Main--fluid Main--withSidebar">
        <aside class="TitleAside TitleAside--navBar">
            <h3><span alt="Lower-case delta">%</span></h3>
            <nav class="TitleAside-navigation">
                <h3>Documentation</h3>
                <mws-docsidebar path="api.html" modulo-innerhtml="">
<ul>
    
        <li class="
            
            "><a href="/docs/">Table of Contents</a>
            
        </li>
    
        <li class="
            
                ginactive
            
            "><a href="/docs/tutorial_part1.html">Tutorial</a>
            
        </li>
    
        <li class="
            
                ginactive
            
            "><a href="/docs/cparts.html">CParts</a>
            
        </li>
    
        <li class="
            
                ginactive
            
            "><a href="/docs/templating.html">Templating</a>
            
        </li>
    
        <li class="
            
                ginactive
            
            "><a href="/docs/templating-reference.html">Template Reference</a>
            
        </li>
    
        <li class="
            
                ginactive
            
            "><a href="/docs/directives.html">Lifecycle &amp; Directives</a>
            
        </li>
    
        <li class="
            
                gactive
            
            "><a href="/docs/api.html">API &amp; Extension</a>
            
                
                    <ul>
                    
                        <li><a href="/docs/api.html#cparts">Custom CParts</a>
                        
                        </li>
                    
                        <li><a href="/docs/api.html#spares">CPart Spares</a>
                        
                        </li>
                    
                        <li><a href="/docs/api.html#template">Custom Templating</a>
                        
                        </li>
                    
                        <li><a href="/docs/api.html#customfilters">Custom Filters</a>
                        
                        </li>
                    
                        <li><a href="/docs/api.html#customtags">Custom Template Tags</a>
                        
                        </li>
                    
                        <li><a href="/docs/api.html#customtags">Custom Template Syntax</a>
                        
                        </li>
                    
                        <li><a href="/docs/api.html#modrec">ModRec</a>
                        
                        </li>
                    
                        <li><a href="/docs/api.html#cursor">DOMCursor</a>
                        
                        </li>
                    
                    </ul>
                
            
        </li>
    
        <li class="
            
                ginactive
            
            "><a href="/docs/example-library.html">Example Library</a>
            
        </li>
    
        <li class="
            
                ginactive
            
            "><a href="/docs/project-info.html">Project Info</a>
            
        </li>
    


    <!--
    <li>
        Other resources:

        <ul>
            <li>
                <a href="/docs/faq.html">FAQ</a>
            <li title="Work in progress: Finalizing source code and methodically annotating entire file with extensive comments.">
                Literate Source*<br /><em>* Coming soon!</em>
            </li>
        </ul>

    </li>
    -->
    <!--<a href="/literate/src/Modulo.html">Literate source</a>-->
</ul>
</mws-docsidebar>
            </nav>
        </aside>
        <aside style="border: none">
            

<h1>API &amp; Extension</h1>

<p>This documentation is intended for developers intending to write their own
<em>CParts</em>, developers looking for deeper customization of Modulo (such as
using a different templating engine or DOM reconciler), or developers looking
for a deeper understanding of ways to extend Modulo with JavaScript.</p>


<p><strong>Note:</strong> Modulo is still under heavy development. While the
external, component development API might change somewhat as the project
transitions to a beta version and eventually a v1.0, this internal JavaScript
API is much more likely to have larger changes before stabilizing. This is
because it closely follows internal implementations.</p>


<mws-section name="cparts" modulo-innerhtml="CParts">
        <a class="secanchor" title="Click to focus on this section." id="cparts" name="cparts" href="#cparts">#</a>
        <h2>CParts</h2>
    </mws-section>

<p>Want to write your own CPart? Examine the following code: Here we're
defining a CPart and then instantiating it immediately below.</p>
<mws-demo demotype="minipreview" text="
<script>
// CParts all extend Modulo.ComponentPart, and then override as many
// callbacks as necessary to perform the intended &quot;middleware&quot;-style
// functionality of the CPart.
class MyCoolPart extends Modulo.ComponentPart {
    static factoryCallback(partOptions, factory, renderObj) {
        // Uncomment to see args recieved for &quot;factory&quot; callback
        //console.log(&quot;Factory:&quot;, partOptions, factory, renderObj);
    }
    renderCallback(renderObj) {
        // Now, we can add our own behavior. In this case, our CPart
        // acts a little like a Template (it modifies innerHTML)
        renderObj.component.innerHTML = this.attrs.exampleattr;
    }
}
// Important: This is what actually &quot;registers&quot; with Modulo
Modulo.cparts.mycoolpart = MyCoolPart;
</script>

<mycoolpart
    exampleattr=&quot;<h3>Hello CPart World</h3>&quot;
></mycoolpart>
" modulo-innerhtml=""><div class="demo-wrapper
             demo-wrapper__minipreview
        
        
        demo-wrapper__notabs     
    ">
    

    <div class="editor-toolbar">
        <p style="font-size: 11px; width: 120px; margin-right: 10px; text-align: right;
                     display: none; ">
            <em>Note: This is meant for exploring features. Your work will not be saved.</em>
        </p>

        

        
            <button class="m-Btn" title="Toggle full screen view of code" @click:="script.doFullscreen">
                
                    <span alt="Go Full Screen">↗</span>
                
            </button>
            &nbsp;
            <button class="m-Btn" title="Run a preview of this code" @click:="script.doRun">
                Run <span alt="Refresh">⟳</span>
            </button>
        

    </div>

    <div class="side-by-side-panes">
        <div class="editor-wrapper">
            <div modulo-ignore="">
            </div>
        </div>

        
            <div class="editor-minipreview">
                <div modulo-ignore="">
                    <e3g1-example mm-ignore="mm-ignore" modulo-innerhtml=""><h3>Hello CPart World</h3></e3g1-example>
                </div>
            </div>
        

    </div>
</div>

</mws-demo>

<p>Note that normally you will not define CParts in script tags and then use
them immediately: There's no reason for this, as you could just hook into the
same callbacks using the <em>Script</em> CPart. Instead, typically, CParts
should be written in a separate, ordinary JS file (e.g. not a Modulo HTML
file), or at the very most in a "module" at the top of a component library.</p>

<mws-section name="spares" modulo-innerhtml="CPart Spares">
        <a class="secanchor" title="Click to focus on this section." id="spares" name="spares" href="#spares">#</a>
        <h2>CPart Spares</h2>
    </mws-section>

<p>If you have extra car parts lying around, you call them <em>spare
parts</em>, or just "spares". In Modulo, extra or inactive CParts are also
called Spares.</p>


<h3>Mechanics of Spares</h3>

<p>The use for this might be to have more than one <em>Template</em> that can
be switched out depending on what data model is being used, more than one
<em>State</em> to allow for both private and shared data between components, or
more than one <em>Script</em> to be swapped to quickly change behavior based on
if the user is logged in or out. Many of these things might be doable without
CPart spares, such as with if-statements, but spares provide a paradigm for
working comfortably with multiple CParts.</p>

<p>When you have duplicate CParts of the same type in a component, <em>only
one</em> CPart a time of each type is the "active" CPart, accessible in the
<code>element.cparts</code> object. That is to say, there can never be more
than one active CPart.  Both the active and extra (spare) CParts are available
in <code>element.cpartSpares</code>. Simply by assigning a property of
<code>element.cparts</code> you can select which one is active.</p>

<p>By default, the last CPart defined will be the active CPart.</p>

<p>For a concrete example, examine how the following behaves:</p>

<mws-demo demotype="minipreview" text="
<template name=&quot;shop&quot;>
    <nav>Shop|<a @click:=script.swap payload=&quot;home&quot;>Home</a></nav>
    <h1>Shop</h1>
    <p>$10 - A banana</p>
</template>
<template name=&quot;home&quot;>
    <nav><a @click:=script.swap payload=&quot;shop&quot;>Shop</a>|Home</nav>
    <h1>Home</h1>
    <p>Welcome to my banana stand!</p>
</template>
<script>
    // swap: Set the active cpart by searching through the spare
    // array and selecting the one with a name matching payload:
    function swap(payload) {
        element.cparts.template = element.cpartSpares.template
            .find(({attrs}) => attrs.name === payload);
    }
</script>

<!-- some basic styling -->
<style>
nav {
    background: black;
    color: gray;
    padding: 3px;
}
a {
    color: lightblue;
    text-decoration: underline;
    cursor: pointer;
}
</style>
" modulo-innerhtml=""><div class="demo-wrapper
             demo-wrapper__minipreview
        
        
        demo-wrapper__notabs     
    ">
    

    <div class="editor-toolbar">
        <p style="font-size: 11px; width: 120px; margin-right: 10px; text-align: right;
                     display: none; ">
            <em>Note: This is meant for exploring features. Your work will not be saved.</em>
        </p>

        

        
            <button class="m-Btn" title="Toggle full screen view of code" @click:="script.doFullscreen">
                
                    <span alt="Go Full Screen">↗</span>
                
            </button>
            &nbsp;
            <button class="m-Btn" title="Run a preview of this code" @click:="script.doRun">
                Run <span alt="Refresh">⟳</span>
            </button>
        

    </div>

    <div class="side-by-side-panes">
        <div class="editor-wrapper">
            <div modulo-ignore="">
            </div>
        </div>

        
            <div class="editor-minipreview">
                <div modulo-ignore="">
                    <e4g1-example mm-ignore="mm-ignore" modulo-innerhtml="">
    <nav><a @click:="script.swap" payload="shop">Shop</a>|Home</nav>
    <h1>Home</h1>
    <p>Welcome to my banana stand!</p>
</e4g1-example>
                </div>
            </div>
        

    </div>
</div>

</mws-demo>


<p><strong>Note:</strong> Swapping templates should <em>not</em> be a suitable
replacement for real links or an adequate frontend routing system. In other
words, consider swapping templates as a technique only for things like
alternate themes, filter views, logged-in vs logged-out, and other such
scenarios, but not for general page navigation. This is because they break
many web standards, confuse search bots crawling for SEO, and ruin user
experience by not looking like links for accessibility purposes, having no URL,
and no effect on browser history.</p>


<h3>CPart spares and renderObj</h3>

<p>CPart spares (inactive CParts) can still influence your component, even if
they are never activated.
Specifically, they still get the <code>loadCallback</code> and
<code>factoryCallback</code> invoked, meaning they still contribute to the
<code>loadObj</code> and the <code>baseRenderObj</code> like any other CPart of
their type (<a href="/docs/directives.html#renderobj">see relevant docs on
these renderObj</a>). For some types of spares, this effectively causes them to
be "squashed" into a single renderObj.</p>



        </aside>
    </main>


<footer>
    <main>
        (C) 2021 - Michael Bethencourt - Documentation under LGPL 3.0
    </main>
</footer>

<script src="/js/codemirror_5.63.0/codemirror_bundled.js"></script><script src="/js/modulo-build-121.11-e18lph.js"></script></body>