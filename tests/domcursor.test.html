<component name="DomCursorTester"><testsuite>

<test name="Test DomCursor hasNext() and next() with simple structures">
    <script name="hasNext() and next() with empty mock data">
        const fakeNode = { firstChild: null };
        const cursor = new Modulo.reconcilers.DOMCursor(fakeNode, fakeNode);
        const hasNext = cursor.hasNext();
        const next = JSON.stringify(cursor.next());
        const emptyNext = JSON.stringify([null, null]);
        assert: hasNext === false && next === emptyNext
    </script>

    <script name="hasNext() and next() with first item">
        const md = Modulo.utils.makeDiv;
        const node = md('<p>A</p><p>B</p>');
        const rival = md('<p>A</p><p>B</p>');
        const cursor = new Modulo.reconcilers.DOMCursor(node, rival);
        const hasNext = cursor.hasNext();
        const next = cursor.next();
        const t0 = next[0] && next[0].textContent;
        const t1 = next[1] && next[1].textContent;
        assert: hasNext === true && t0 === 'A' && t1 === 'A';
    </script>


    <script name="hasNext() and next() can access second item">
        const md = Modulo.utils.makeDiv;
        const node = md('<p>A</p><p>B</p>');
        const rival = md('<p>A</p><p>B</p>');
        const cursor = new Modulo.reconcilers.DOMCursor(node, rival);
        cursor.next(); // Skip first
        const hasNext = cursor.hasNext();
        const next = cursor.next();
        const t0 = next[0] && next[0].textContent;
        const t1 = next[1] && next[1].textContent;
        assert: hasNext === true && t0 === 'B' && t1 === 'B';
    </script>

    <script name="hasNext() and next() reaches end">
        const md = Modulo.utils.makeDiv;
        const node = md('<p>A</p><p>B</p>');
        const rival = md('<p>A</p><p>B</p>');
        const cursor = new Modulo.reconcilers.DOMCursor(node, rival);
        cursor.next(); // Skip first
        cursor.next(); // Skip second
        // Now ensure has reached end
        const hasNext = cursor.hasNext();
        const next = JSON.stringify(cursor.next());
        const emptyNext = JSON.stringify([null, null]);
        assert: hasNext === false && next === emptyNext;
    </script>
</test>


<test name="Test DomCursor descent with nested structures">

    <script name="hasNext() and next() initial is as expected">
        const md = Modulo.utils.makeDiv;
        const node = md('<p>A<span>B</span>C</p><p>D</p>');
        const rival = md('<p>A<span>B</span>C</p><p>D</p>');
        const cursor = new Modulo.reconcilers.DOMCursor(node, rival);
        const hasNext = cursor.hasNext();
        const next = cursor.next();
        const t0 = next[0] && next[0].textContent;
        const t1 = next[1] && next[1].textContent;
        assert: hasNext === true && t0 === 'ABC' && t1 === 'ABC';
    </script>


<!--
    <script name="hasNext() and next() can descend">
        const md = Modulo.utils.makeDiv;
        const node = md('<p>A<span>B</span>C</p><p>D</p>');
        const rival = md('<p>A<span>B</span>C</p><p>D</p>');
        const cursor = new Modulo.reconcilers.DOMCursor(node, rival);
        cursor.next(); // skip over first, descend into second
        const hasNext = cursor.hasNext();
        const next = cursor.next();
        const t0 = next[0] && next[0].textContent;
        const t1 = next[1] && next[1].textContent;
        assert: hasNext === true && t0 === 'B' && t1 === 'B';
    </script>
-->

</test>


</testsuite></component>
