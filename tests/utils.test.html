<component name="UtilTester"><testsuite>

<test name="utils.parseDirectives">
    <script name="Ensure defined">
        // helper utility function:
        Modulo.utils.parseDir = function parseDir (rawName) {
            return JSON.stringify(parseDirectives(rawName), null, 2);
        }

        const { parseDirectives } = Modulo.utils;
        assert: parseDirectives 
    </script>

    <script name="Can parse shortcuts">
        const { parseDir } = Modulo.utils;
        // <a b="valb" c:="valc" @d="vald"></a>
        const result = parseDir('c:', 'valc');
        const expected = JSON.stringify([{
            attrName: 'c',
            rawName: 'c:',
            directiveName: 'component.dataProp',
            name: '[component.dataProp]c',
        }], null, 2);
        assert: result === expected
    </script>

    <script name="Can parse multiple shortcuts">
        const { parseDir } = Modulo.utils;
        const result = parseDir('@abc:', 'def');
        const expected = JSON.stringify([
                {
                    attrName: 'abc',
                    rawName: '@abc:',
                    directiveName: 'component.dataProp',
                    name: '[component.dataProp][component.event]abc',
                },
                {
                    attrName: 'abc',
                    rawName: '@abc:',
                    directiveName: 'component.event',
                    name: '[component.dataProp][component.event]abc',
                },
            ], null, 2);
        assert: result === expected
    </script>

    <script name="Can parse multiple directives">
        const { parseDir } = Modulo.utils;
        // <a b="valb" c:="valc" @d="vald"></a>
        const result = parseDir('[a][b][c][d]e', 'vale');
        const expected = JSON.stringify([
                { attrName: 'e', rawName: '[a][b][c][d]e',
                    directiveName: 'a', name: '[a][b][c][d]e', },
                { attrName: 'e', rawName: '[a][b][c][d]e',
                    directiveName: 'b', name: '[a][b][c][d]e', },
                { attrName: 'e', rawName: '[a][b][c][d]e',
                    directiveName: 'c', name: '[a][b][c][d]e', },
                { attrName: 'e', rawName: '[a][b][c][d]e',
                    directiveName: 'd', name: '[a][b][c][d]e', },
            ], null, 2);
        assert: result === expected
    </script>

    <script name="Can parse bare directives">
        const { parseDir } = Modulo.utils;
        // <a b="valb" c:="valc" @d="vald"></a>
        const result = parseDir('[testing]', '');
        const expected = JSON.stringify([
                { attrName: '', rawName: '[testing]',
                    directiveName: 'testing', name: '[testing]', },
            ], null, 2);
        assert: result === expected
    </script>

    <script name="Can detect when no directives">
        const { parseDirectives } = Modulo.utils;
        const result = parseDirectives('just-a-normal-attribute-folks');
        const expected = null;
        assert: result === expected
    </script>


    <script name="Can detect when no directives or shortcuts">
        const { parseDirectives } = Modulo.utils;
        const result = parseDirectives('just-a$no.b.c:a---i??te-folks');
        const expected = null;
        assert: result === expected
    </script>

</test>

</testsuite></component>
