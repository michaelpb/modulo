<component name="LilTester">
    <template><p>Defhij</p></template>
</component>

<component name="PassThrough">
    <Props
        suffix
    ></Props>
    <template>
        <p>Before{{ props.suffix }}</p>
        <div [component.slot]>Defhij</div>
        <p>After{{ props.suffix }}</p>
    </template>
</component>


<component name="CompositionTester1">
<template>
    <div>Abc</div>
    <LilTester></LilTester>
</template>

<TestSuite>

    <Test>
        <template name="Renders as expected">
            <div>Abc</div>
            <x-LilTester><p>Defhij</p></x-LilTester>
        </template>
        <script skip-rerender>
            const expected = `
              <div>Abc</div>
              <x-liltester><p>Defhij</p></x-liltester>
            `.trim().replace(/\s+/g, '');
            const ih = element.innerHTML.trim().replace(/\s+/g, '');
            assert: ih === expected
        </script>
    </Test>
</TestSuite>
</Component>



<component name="CompositionTester2">

<Template>
    <div>Abc</div>
    <PassThrough><p>{{state.num1}}</p><p>{{state.num2}}</p></PassThrough>
    <div>Def</div>
</Template>

<State
  num1:=123
  num2:=456
></State>

<TestSuite>

    <Test>
        <template name="Renders once as expected">
            <div>Abc</div>
            <x-PassThrough>
                <p>Before</p>
                <div [component.slot]>
                    <p>123</p><p>456</p>
                </div>
                <p>After</p>
            </x-PassThrough>
            <div>Def</div>
        </template>

        <template name="Renders second time as expected">
            <div>Abc</div>
            <x-PassThrough>
                <p>Before</p>
                <div [component.slot]>
                    <p>123</p><p>456</p>
                </div>
                <p>After</p>
            </x-PassThrough>
            <div>Def</div>
        </template>

        <state
            num1:=789
            num2:=234
        ></state>

        <template name="Renders third time with state change">
            <div>Abc</div>
            <x-PassThrough>
                <p>Before</p>
                <div [component.slot]>
                    <p>789</p><p>234</p>
                </div>
                <p>After</p>
            </x-PassThrough>
            <div>Def</div>
        </template>

        <state
            num1:=234
            num2:=234
        ></state>

        <template name="Renders forth time with state change">
            <div>Abc</div>
            <x-PassThrough>
                <p>Before</p>
                <div [component.slot]>
                    <p>234</p><p>234</p>
                </div>
                <p>After</p>
            </x-PassThrough>
            <div>Def</div>
        </template>

    </Test>

</TestSuite>

</Component>


<component name="CompositionTester3">

<Template>
    <div>Abc</div>
    <PassThrough>
      <p>{{state.num1}}</p>
      <PassThrough>
        <p>{{state.num2}}</p>
      </PassThrough>
      <p>{{state.num3}}</p>
    </PassThrough>
    <div>Def</div>
</Template>

<State
  num1:=123
  num2:=456
  num3:=789
></State>

<TestSuite>

    <Test>
        <template name="Renders with multiple layers of passthrough">
            <div>Abc</div>
            <x-PassThrough>
                <p>Before</p>
                <div [component.slot]>
                    <p>123</p>
                    <x-PassThrough>
                        <p>Before</p>
                        <div [component.slot]>
                            <p>456</p>
                        </div>
                        <p>After</p>
                    </x-PassThrough>
                    <p>789</p>
                </div>
                <p>After</p>
            </x-PassThrough>
            <div>Def</div>
        </template>

        <state
          num1:=111
          num2:=222
          num3:=333
        ></state>

        <template name="Reflects state change with multiple layers of passthrough">
            <div>Abc</div>
            <x-PassThrough>
                <p>Before</p>
                <div [component.slot]>
                    <p>111</p>
                    <x-PassThrough>
                        <p>Before</p>
                        <div [component.slot]>
                            <p>222</p>
                        </div>
                        <p>After</p>
                    </x-PassThrough>
                    <p>333</p>
                </div>
                <p>After</p>
            </x-PassThrough>
            <div>Def</div>
        </template>
    </Test>

</TestSuite>

</Component>


<component name="CompositionTester4">

<Template>
    <div>Abc</div>
    <PassThrough suffix="{{ state.suff }}">
        <p>{{state.num1}}</p>
        <p>{{state.num2}}</p>
    </PassThrough>
    <div>Def</div>
</Template>

<State
  num1:=123
  num2:=456
  suff="AAA"
></State>

<TestSuite>

    <Test>

        <template name="Renders with prop on subcomponent">
            <div>Abc</div>
            <x-PassThrough suffix="AAA">
                <p>BeforeAAA</p>
                <div [component.slot]>
                    <p>123</p>
                    <p>456</p>
                </div>
                <p>AfterAAA</p>
            </x-PassThrough>
            <div>Def</div>
        </template>

        <!--
        <state
          num1:=111
          num2:=222
          suff="BBB"
        ></state>

        <template name="Renders with prop and subdom change on subcomponent">
            <div>Abc</div>
            <x-PassThrough suffix="BBB">
                <p>BeforeBBB</p>
                <div [component.slot]>
                    <p>111</p>
                    <p>222</p>
                </div>
                <p>AfterBBB</p>
            </x-PassThrough>
            <div>Def</div>
        </template>
        -->
    </Test>

</TestSuite>

</Component>

